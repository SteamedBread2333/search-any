<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Any</title>
    <script>
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'üò∞ Á≥üÁ≥ïÔºÅÁ®ãÂ∫èÂ¥©Ê∫ÉÂï¶ÔºÅ';
            } else {
                document.title = 'Search Any';
                setTimeout(() => {
                    document.title = 'ü§© ÂìáÂì¶ÔºÅÊÅ¢Â§çÊ≠£Â∏∏Âï¶ÔºÅ';
                    setTimeout(() => {
                        document.title = 'Search Any';
                    }, 1500);
                }, 300);
            }
        });
    </script>
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --input-bg: #f5f5f5;
            --input-border: #e0e0e0;
        }

        .github-corner {
            position: absolute;
            top: 0;
            right: 0;
            z-index: 10;
        }

        .github-corner svg {
            fill: #151513;
            color: #fff;
        }

        .github-corner:hover .octo-arm {
            animation: octocat-wave 560ms ease-in-out;
        }

        @keyframes octocat-wave {

            0%,
            100% {
                transform: rotate(0);
            }

            20%,
            60% {
                transform: rotate(-25deg);
            }

            40%,
            80% {
                transform: rotate(10deg);
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 480px;
            padding: 0 20px;
            box-sizing: border-box;
        }

        .random-image-container {
            text-align: center;
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .random-image {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .search-box {
            width: 100%;
            margin-bottom: 20px;
        }

        #search-input {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            border: 1px solid var(--input-border);
            border-radius: 24px;
            background-color: var(--input-bg);
            color: var(--text-color);
            outline: none;
            box-sizing: border-box;
        }

        .engine-options {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .engine-option {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 12px;
            border-radius: 16px;
            background-color: var(--input-bg);
            cursor: pointer;
            border: 1px solid transparent;
        }

        .engine-option.selected {
            border-color: var(--text-color);
        }

        .engine-option input {
            display: none;
        }

        .engine-option label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }

        .shortcut-hint {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
            text-align: center;
        }

        /* Âø´Êç∑ÊñπÂºèÊ†∑Âºè */
        .shortcuts-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .shortcut-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            background-color: var(--input-bg);
            cursor: pointer;
            transition: transform 0.2s;
            text-align: center;
            position: relative;
        }

        .shortcut-item:hover {
            transform: translateY(-3px);
        }

        .shortcut-icon {
            width: 32px;
            height: 32px;
            margin-bottom: 8px;
            border-radius: 4px;
        }

        .shortcut-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 100%;
        }

        .shortcut-description {
            font-size: 12px;
            color: #666;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .delete-shortcut-btn, .edit-shortcut-btn {
            position: absolute;
            top: 5px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.9);
            border: none;
            color: #999;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            align-items: center;
            justify-content: center;
        }

        .delete-shortcut-btn {
            right: 5px;
        }

        .edit-shortcut-btn {
            right: 35px;
        }

        .shortcut-item:hover .delete-shortcut-btn,
        .shortcut-item:hover .edit-shortcut-btn {
            display: flex;
        }

        .delete-shortcut-btn:hover {
            background-color: #ff4444;
            color: white;
            transform: scale(1.1);
        }

        .edit-shortcut-btn:hover {
            background-color: #4285f4;
            color: white;
            transform: scale(1.1);
        }

        .add-shortcut-container {
            text-align: center;
            margin: 10px 0;
        }

        .add-shortcut-btn {
            padding: 8px 16px;
            background-color: var(--input-bg);
            border: 1px solid var(--input-border);
            border-radius: 16px;
            cursor: pointer;
            font-size: 14px;
        }

        .add-shortcut-btn:hover {
            background-color: var(--input-border);
        }

        /* Ê®°ÊÄÅÊ°ÜÊ†∑Âºè */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: var(--bg-color);
            margin: 10% auto;
            padding: 20px;
            border: 1px solid var(--input-border);
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .close {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--text-color);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--input-border);
            border-radius: 4px;
            background-color: var(--input-bg);
            color: var(--text-color);
            box-sizing: border-box;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-group input[type="file"] {
            margin-top: 5px;
        }

        .modal-content button {
            width: 100%;
            padding: 10px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        .modal-content button:hover {
            background-color: #3367d6;
        }

        .theme-toggle {
            display: flex;
            gap: 10px;
            position: absolute;
            top: 20px;
            right: 85px;
        }

        .toolbox-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 8px 16px;
            background-color: var(--input-bg);
            border-radius: 16px;
            cursor: pointer;
            border: 1px solid var(--input-border);
        }

        .toolbox-drawer {
            position: absolute;
            top: 60px;
            left: 20px;
            background-color: var(--bg-color);
            border: 1px solid var(--input-border);
            border-radius: 8px;
            padding: 10px;
            display: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .toolbox-item {
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            margin: 4px 0;
        }

        .toolbox-item:hover {
            background-color: var(--input-bg);
        }

        .theme-btn {
            padding: 6px 12px;
            border-radius: 16px;
            background-color: white;
            border: none;
            cursor: pointer;
            font-size: 18px;
        }

        .theme-btn.active {
            background-color: #4285f4;
            color: white;
            border-color: #4285f4;
        }

        [data-theme="dark"] .theme-btn {
            background-color: #2d2d2d;
        }

        /* ‰∏ªÈ¢òÊ†∑Âºè */
        [data-theme="light"] {
            --bg-color: #ffffff;
            --text-color: #333333;
            --input-bg: #f5f5f5;
            --input-border: #e0e0e0;
        }

        [data-theme="dark"] {
            --bg-color: #1e1e1e;
            --text-color: #f5f5f5;
            --input-bg: #2d2d2d;
            --input-border: #444444;
        }

        @media (prefers-color-scheme: dark) {
            :root:not([data-theme="light"]) {
                --bg-color: #1e1e1e;
                --text-color: #f5f5f5;
                --input-bg: #2d2d2d;
                --input-border: #444444;
            }
        }
    </style>
    <a href="https://github.com/SteamedBread2333/search-any" class="github-corner" aria-label="View source on GitHub">
        <svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path
                d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                fill="currentColor" class="octo-arm"></path>
            <path
                d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                fill="currentColor" class="octo-body"></path>
        </svg>
    </a>
</head>

<body>
    <div class="toolbox-toggle" id="toolbox-toggle">üß∞ Â∑•ÂÖ∑ÁÆ±</div>
    <div class="toolbox-drawer" id="toolbox-drawer">
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109400451645491', '_blank') : window.open('json2typescript.html', '_blank')">
            üîÑ JSONËΩ¨TypeScript
        </div>
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109291132305459', '_blank') : window.open('image2base64.html', '_blank')">
            üñºÔ∏è ÂõæÁâáËΩ¨Base64
        </div>
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109166636302345', '_blank') : window.open('color-converter.html', '_blank')">
            üé® È¢úËâ≤ËΩ¨Êç¢Â∑•ÂÖ∑
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/rmbg-tool`, '_blank')">
            üå† Âà†Èô§ËÉåÊôØÂ∑•ÂÖ∑
        </div>
        <div class="toolbox-item" onclick="window.open(`https://steamedbread2333.github.io/mobile-massage`, '_blank')">
            üíÜ‚Äç‚ôÇÔ∏è ÊâãÊú∫WebÈ©¨ÊùÄÈ∏°
        </div>
        <div class="toolbox-item"
            onclick="window.open(`https://github.com/SteamedBread2333/shell-commands/tree/main/proxy-to-https`, '_blank')">
            ü§ñ Êú¨Âú∞‰ª£ÁêÜÁîü‰∫ßÁéØÂ¢É
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/shell-commands`, '_blank')">
            üöß JS CoderË£ÖÊú∫ÂøÖÂ§á
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/dctc`, '_blank')">
            üë®‚Äçüíª TsxËΩ¨Êç¢Html
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/mtgit`, '_blank')">
            ü§ù Â§ö‰ªìÂ∫ìÂêàÂπ∂Â∑•ÂÖ∑
        </div>
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109523451645492', '_blank') : window.open('bmi-calculator.html', '_blank')">
            ‚öñÔ∏è BMI ËÆ°ÁÆóÂô®
        </div>
    </div>

    <div class="container">
        <div class="random-image-container">
            <img src="https://picsum.photos/400/300" alt="ÈöèÊú∫ÂõæÁâá" class="random-image">
        </div>
        <div class="search-box">
            <input type="text" id="search-input" placeholder="ÊêúÁ¥¢‚Ä¶" autofocus>
            <div class="shortcut-hint"></div>
        </div>
        
        <div class="engine-options">
            <div class="engine-option" data-engine="google">
                <input type="radio" name="engine" id="google" checked>
                <label for="google">üîç Google</label>
            </div>
            <div class="engine-option" data-engine="baidu">
                <input type="radio" name="engine" id="baidu">
                <label for="baidu">üîç ÁôæÂ∫¶</label>
            </div>
            <div class="engine-option" data-engine="bing">
                <input type="radio" name="engine" id="bing">
                <label for="bing">üîç ÂøÖÂ∫î</label>
            </div>
        </div>

        <!-- Âø´Êç∑ÊñπÂºèÂå∫Âüü -->
        <div class="shortcuts-container" id="shortcuts-container">
            <!-- Âø´Êç∑ÊñπÂºèÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÊ∑ªÂä† -->
        </div>
        
        <!-- Ê∑ªÂä†Âø´Êç∑ÊñπÂºèÊåâÈíÆ -->
        <div class="add-shortcut-container">
            <button class="add-shortcut-btn" id="add-shortcut-btn">‚ûï Ê∑ªÂä†Âø´Êç∑ÊñπÂºè</button>
        </div>
        
        <!-- Ê∑ªÂä†Âø´Êç∑ÊñπÂºèÊ®°ÊÄÅÊ°Ü -->
        <div class="modal" id="shortcut-modal">
            <div class="modal-content">
                <span class="close" id="close-modal">&times;</span>
                <h2>Ê∑ªÂä†Âø´Êç∑ÊñπÂºè</h2>
                <form id="shortcut-form">
                    <div class="form-group">
                        <label for="shortcut-name">ÂêçÁß∞:</label>
                        <input type="text" id="shortcut-name" required>
                    </div>
                    <div class="form-group">
                        <label for="shortcut-url">ÈìæÊé•:</label>
                        <input type="url" id="shortcut-url" required>
                    </div>
                    <div class="form-group">
                        <label for="shortcut-description">ÊèèËø∞:</label>
                        <textarea id="shortcut-description"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="shortcut-icon">ÂõæÊ†á (ÂèØÈÄâ):</label>
                        <input type="text" id="shortcut-icon" placeholder="ÂõæÊ†áURL">
                        <input type="file" id="shortcut-icon-upload" accept="image/*">
                    </div>
                    <button type="submit">Ê∑ªÂä†</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // ÊêúÁ¥¢ÂºïÊìéÈÖçÁΩÆ
        const engines = {
            google: {
                name: 'Google',
                url: 'https://www.google.com/search?q='
            },
            baidu: {
                name: 'ÁôæÂ∫¶',
                url: 'https://www.baidu.com/s?wd='
            },
            bing: {
                name: 'ÂøÖÂ∫î',
                url: 'https://www.bing.com/search?q='
            }
        };

        // DOMÂÖÉÁ¥†
        const searchInput = document.getElementById('search-input');
        const engineOptions = document.querySelectorAll('.engine-option');

        // ÂΩìÂâçÈÄâÊã©ÁöÑÊêúÁ¥¢ÂºïÊìé
        let currentEngine = 'google';

        // Ê£ÄÊü•ÂüüÂêçÊòØÂê¶ÂåÖÂê´juejin
        const isJuejinDomain = window.location.href.includes('code.devrank');
        
        // Â∑•ÂÖ∑ÁÆ±ÂàáÊç¢
        document.getElementById('toolbox-toggle').addEventListener('click', function () {
            this.focus();
        });
        
        document.addEventListener('click', function(event) {
            const drawer = document.getElementById('toolbox-drawer');
            const toggle = document.getElementById('toolbox-toggle');
            
            if (drawer.style.display === 'block' && 
                !drawer.contains(event.target) && 
                !toggle.contains(event.target)) {
                drawer.style.display = 'none';
            }
        });
        
        document.getElementById('toolbox-toggle').addEventListener('click', function () {
            const drawer = document.getElementById('toolbox-drawer');
            drawer.style.display = drawer.style.display === 'block' ? 'none' : 'block';
        });

        // Âø´Êç∑ÊñπÂºèÂäüËÉΩ
        let shortcuts = [];
        
        // ÂàùÂßãÂåñ
        function init() {
            // ‰ªélocalStorageËØªÂèñ‰∏äÊ¨°ÈÄâÊã©ÁöÑÊêúÁ¥¢ÂºïÊìé
            const savedEngine = localStorage.getItem('searchEngine');
            if (savedEngine && engines[savedEngine]) {
                currentEngine = savedEngine;
                document.getElementById(savedEngine).checked = true;
                updateEngineSelection();
            }

            // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨
            searchInput.addEventListener('keydown', handleSearch);
            engineOptions.forEach(option => {
                option.addEventListener('click', handleEngineChange);
            });

            // Ê∑ªÂä†Âø´Êç∑ÈîÆÁõëÂê¨
            document.addEventListener('keydown', handleShortcuts);

            // ‰∏ªÈ¢òÊ®°ÂºèÂàáÊç¢
            const themeToggle = document.createElement('div');
            themeToggle.className = 'theme-toggle';
            themeToggle.innerHTML = `
             <button class="theme-btn" data-theme="auto">üåì</button>
             <button class="theme-btn" data-theme="light">üåû</button>
             <button class="theme-btn" data-theme="dark">üåô</button>
         `;
            document.body.appendChild(themeToggle);

            // ÂàùÂßãÂåñ‰∏ªÈ¢ò
            let currentTheme = 'auto';
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                currentTheme = savedTheme;
                applyTheme(currentTheme);
            }

            // ‰∏ªÈ¢òÂàáÊç¢‰∫ã‰ª∂
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    currentTheme = btn.dataset.theme;
                    localStorage.setItem('theme', currentTheme);
                    applyTheme(currentTheme);
                });
            });

            // Â∫îÁî®‰∏ªÈ¢ò
            function applyTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);

                // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.theme === theme);
                });
            }

            // ÊòæÁ§∫Âø´Êç∑ÈîÆÊèêÁ§∫
            function showShortcutHint() {
                const hint = document.createElement('div');
                hint.className = 'shortcut-hint';
                hint.textContent = 'Âø´Êç∑ÈîÆ: Ctrl+KËÅöÁÑ¶ | Ctrl+1/2/3ÂàáÊç¢ | Ctrl+LÊ∏ÖÁ©∫';
                document.querySelector('.search-box').appendChild(hint);
            }

            showShortcutHint();
            
            // ÂàùÂßãÂåñÂø´Êç∑ÊñπÂºèÂäüËÉΩ
            initShortcuts();
        }

        // ÂàùÂßãÂåñÂø´Êç∑ÊñπÂºè
        function initShortcuts() {
            // ‰ªélocalStorageÂä†ËΩΩÂø´Êç∑ÊñπÂºè
            loadShortcuts();
            
            // ÊòæÁ§∫Âø´Êç∑ÊñπÂºè
            renderShortcuts();
            
            // Ê∑ªÂä†Âø´Êç∑ÊñπÂºèÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('add-shortcut-btn').addEventListener('click', () => {
                document.getElementById('shortcut-modal').style.display = 'block';
            });
            
            // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
            document.getElementById('close-modal').addEventListener('click', () => {
                document.getElementById('shortcut-modal').style.display = 'none';
            });
            
            // ÁÇπÂáªÊ®°ÊÄÅÊ°ÜÂ§ñÈÉ®ÂÖ≥Èó≠
            window.addEventListener('click', (event) => {
                const modal = document.getElementById('shortcut-modal');
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Â§ÑÁêÜË°®ÂçïÊèê‰∫§
            document.getElementById('shortcut-form').addEventListener('submit', (e) => {
                e.preventDefault();
                addShortcut();
            });
        }

        // ‰ªélocalStorageÂä†ËΩΩÂø´Êç∑ÊñπÂºè
        function loadShortcuts() {
            const saved = localStorage.getItem('shortcuts');
            if (saved) {
                shortcuts = JSON.parse(saved);
            }
        }

        // ‰øùÂ≠òÂø´Êç∑ÊñπÂºèÂà∞localStorage
        function saveShortcuts() {
            localStorage.setItem('shortcuts', JSON.stringify(shortcuts));
        }

        // Âà†Èô§Âø´Êç∑ÊñπÂºè
        function deleteShortcut(id) {
            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Âø´Êç∑ÊñπÂºèÂêóÔºü')) {
                shortcuts = shortcuts.filter(shortcut => shortcut.id !== id);
                saveShortcuts();
                renderShortcuts();
            }
        }

        // ÁºñËæëÂø´Êç∑ÊñπÂºè
        function editShortcut(id) {
            const shortcut = shortcuts.find(s => s.id === id);
            if (shortcut) {
                // Â°´ÂÖÖË°®ÂçïÊï∞ÊçÆ
                document.getElementById('shortcut-name').value = shortcut.name;
                document.getElementById('shortcut-url').value = shortcut.url;
                document.getElementById('shortcut-description').value = shortcut.description;
                document.getElementById('shortcut-icon').value = shortcut.icon || '';
                
                // Ê∏ÖÁ©∫Êñá‰ª∂ËæìÂÖ•
                document.getElementById('shortcut-icon-upload').value = '';
                
                // ÊòæÁ§∫Ê®°ÊÄÅÊ°Ü
                document.getElementById('shortcut-modal').style.display = 'block';
                
                // Êõ¥ÊîπË°®ÂçïÊèê‰∫§Â§ÑÁêÜÁ®ãÂ∫è
                const form = document.getElementById('shortcut-form');
                
                // ÁßªÈô§ÊóßÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
                const newForm = form.cloneNode(true);
                form.parentNode.replaceChild(newForm, form);
                
                // Ê∑ªÂä†Êñ∞ÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
                newForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    updateShortcut(id);
                });
            }
        }

        // Êõ¥Êñ∞Âø´Êç∑ÊñπÂºè
        function updateShortcut(id) {
            const name = document.getElementById('shortcut-name').value;
            const url = document.getElementById('shortcut-url').value;
            const description = document.getElementById('shortcut-description').value;
            const iconUrl = document.getElementById('shortcut-icon').value;
            
            // Â§ÑÁêÜÂõæÊ†á‰∏ä‰º†
            const fileInput = document.getElementById('shortcut-icon-upload');
            
            // ÊâæÂà∞Ë¶ÅÊõ¥Êñ∞ÁöÑÂø´Êç∑ÊñπÂºè
            const shortcutIndex = shortcuts.findIndex(s => s.id === id);
            if (shortcutIndex !== -1) {
                // Êõ¥Êñ∞Âø´Êç∑ÊñπÂºèÂØπË±°
                const updatedShortcut = {
                    id: id,
                    name,
                    url,
                    description,
                    icon: iconUrl || null
                };
                
                // Â¶ÇÊûúÊúâ‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåËØªÂèñ‰∏∫base64
                if (fileInput.files && fileInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        updatedShortcut.icon = e.target.result;
                        finishUpdateShortcut(shortcutIndex, updatedShortcut);
                    };
                    reader.readAsDataURL(fileInput.files[0]);
                } else {
                    // Â¶ÇÊûúÊ≤°Êúâ‰∏ä‰º†Êñá‰ª∂ÔºåÂ∞ùËØïËé∑ÂèñÁΩëÁ´ôÂõæÊ†á
                    if (!iconUrl) {
                        // ‰ΩøÁî®Êõ¥È´òÊ∏ÖÁöÑfaviconÊúçÂä°
                        updatedShortcut.icon = `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64`;
                    }
                    finishUpdateShortcut(shortcutIndex, updatedShortcut);
                }
            }
        }

        // ÂÆåÊàêÊõ¥Êñ∞Âø´Êç∑ÊñπÂºè
        function finishUpdateShortcut(index, updatedShortcut) {
            shortcuts[index] = updatedShortcut;
            saveShortcuts();
            renderShortcuts();
            
            // ÈáçÁΩÆË°®ÂçïÂπ∂ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
            document.getElementById('shortcut-form').reset();
            document.getElementById('shortcut-modal').style.display = 'none';
            
            // ÊÅ¢Â§çÊ∑ªÂä†Âø´Êç∑ÊñπÂºèÁöÑË°®ÂçïÂ§ÑÁêÜÁ®ãÂ∫è
            const form = document.getElementById('shortcut-form');
            const newForm = form.cloneNode(true);
            form.parentNode.replaceChild(newForm, form);
            newForm.addEventListener('submit', (e) => {
                e.preventDefault();
                addShortcut();
            });
        }

        // Ê∑ªÂä†Âø´Êç∑ÊñπÂºè
        function addShortcut() {
            const name = document.getElementById('shortcut-name').value;
            const url = document.getElementById('shortcut-url').value;
            const description = document.getElementById('shortcut-description').value;
            const iconUrl = document.getElementById('shortcut-icon').value;
            
            // Â§ÑÁêÜÂõæÊ†á‰∏ä‰º†
            const fileInput = document.getElementById('shortcut-icon-upload');
            
            // ÂàõÂª∫Âø´Êç∑ÊñπÂºèÂØπË±°
            const shortcut = {
                id: Date.now(),
                name,
                url,
                description,
                icon: iconUrl || null
            };
            
            // Â¶ÇÊûúÊúâ‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåËØªÂèñ‰∏∫base64
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    shortcut.icon = e.target.result;
                    finishAddShortcut(shortcut);
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                // Â¶ÇÊûúÊ≤°Êúâ‰∏ä‰º†Êñá‰ª∂ÔºåÂ∞ùËØïËé∑ÂèñÁΩëÁ´ôÂõæÊ†á
                if (!iconUrl) {
                    // ‰ΩøÁî®Êõ¥È´òÊ∏ÖÁöÑfaviconÊúçÂä°
                    shortcut.icon = `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64`;
                }
                finishAddShortcut(shortcut);
            }
        }

        // ÂÆåÊàêÊ∑ªÂä†Âø´Êç∑ÊñπÂºè
        function finishAddShortcut(shortcut) {
            shortcuts.push(shortcut);
            saveShortcuts();
            renderShortcuts();
            
            // ÈáçÁΩÆË°®ÂçïÂπ∂ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
            document.getElementById('shortcut-form').reset();
            document.getElementById('shortcut-modal').style.display = 'none';
        }

        // Ê∏≤ÊüìÂø´Êç∑ÊñπÂºè
        function renderShortcuts() {
            const container = document.getElementById('shortcuts-container');
            container.innerHTML = '';
            
            shortcuts.forEach(shortcut => {
                const item = document.createElement('div');
                item.className = 'shortcut-item';
                
                // ÂàõÂª∫Âø´Êç∑ÊñπÂºèÂÜÖÂÆπ
                const iconHtml = shortcut.icon ? `<img src="${shortcut.icon}" alt="${shortcut.name}" class="shortcut-icon">` : '';
                const nameHtml = `<div class="shortcut-name">${shortcut.name}</div>`;
                const descHtml = `<div class="shortcut-description">${shortcut.description}</div>`;
                const editBtnHtml = `<button class="edit-shortcut-btn" data-id="${shortcut.id}">‚úé</button>`;
                const deleteBtnHtml = `<button class="delete-shortcut-btn" data-id="${shortcut.id}">‚úï</button>`;
                
                item.innerHTML = iconHtml + nameHtml + descHtml + editBtnHtml + deleteBtnHtml;
                
                // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                item.addEventListener('click', (e) => {
                    // ÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥°
                    e.stopPropagation();
                    
                    // Â¶ÇÊûúÁÇπÂáªÁöÑÊòØÂà†Èô§ÊåâÈíÆÔºåÂàôÊâßË°åÂà†Èô§ÂäüËÉΩ
                    if (e.target.classList.contains('delete-shortcut-btn')) {
                        e.preventDefault();
                        const id = parseInt(e.target.dataset.id);
                        deleteShortcut(id);
                        return;
                    }
                    
                    // Â¶ÇÊûúÁÇπÂáªÁöÑÊòØÁºñËæëÊåâÈíÆÔºåÂàôÊâßË°åÁºñËæëÂäüËÉΩ
                    if (e.target.classList.contains('edit-shortcut-btn')) {
                        e.preventDefault();
                        const id = parseInt(e.target.dataset.id);
                        editShortcut(id);
                        return;
                    }
                    
                    // Âê¶ÂàôÊâìÂºÄÈìæÊé•
                    window.open(shortcut.url, '_blank');
                });
                
                container.appendChild(item);
            });
        }

        // Â§ÑÁêÜÊêúÁ¥¢
        function handleSearch(e) {
            if (e.key === 'Enter') {
                const query = searchInput.value.trim();
                if (query) {
                    window.open(engines[currentEngine].url + encodeURIComponent(query), '_blank');
                }
            }
        }

        // Â§ÑÁêÜÊêúÁ¥¢ÂºïÊìéÂàáÊç¢
        function handleEngineChange(e) {
            const selectedEngine = this.dataset.engine;
            if (selectedEngine && engines[selectedEngine]) {
                currentEngine = selectedEngine;
                localStorage.setItem('searchEngine', selectedEngine);
                updateEngineSelection();
                searchInput.focus();
            }
        }

        // Êõ¥Êñ∞ÊêúÁ¥¢ÂºïÊìéÈÄâÊã©Áä∂ÊÄÅ
        function updateEngineSelection() {
            engineOptions.forEach(option => {
                if (option.dataset.engine === currentEngine) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        }

        // Â§ÑÁêÜÂø´Êç∑ÈîÆ
        function handleShortcuts(e) {
            // Â§ÑÁêÜÂø´Êç∑ÈîÆ
            if (e.ctrlKey) {
                // Ctrl+K ËÅöÁÑ¶ÊêúÁ¥¢Ê°Ü
                if (e.key.toLowerCase() === 'k') {
                    e.preventDefault();
                    searchInput.focus();
                    return;
                }

                // Ctrl+L Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü
                if (e.key.toLowerCase() === 'l') {
                    e.preventDefault();
                    searchInput.value = '';
                    searchInput.focus();
                    return;
                }

                // Ctrl+1/2/3 ÂàáÊç¢ÊêúÁ¥¢ÂºïÊìé
                if (e.key >= '1' && e.key <= '3') {
                    e.preventDefault();
                    const engineIndex = parseInt(e.key) - 1;
                    const engineKeys = Object.keys(engines);
                    if (engineIndex < engineKeys.length) {
                        currentEngine = engineKeys[engineIndex];
                        localStorage.setItem('searchEngine', currentEngine);
                        document.getElementById(currentEngine).checked = true;
                        updateEngineSelection();
                        searchInput.focus();
                    }
                    return;
                }
            }
        }

        // ÂêØÂä®Â∫îÁî®
        init();
    </script>
</body>

</html>