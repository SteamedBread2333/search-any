<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Any</title>
    <script>
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                document.title = 'ğŸ˜° ç³Ÿç³•ï¼ç¨‹åºå´©æºƒå•¦ï¼';
            } else {
                document.title = 'Search Any';
                setTimeout(() => {
                    document.title = 'ğŸ¤© å“‡å“¦ï¼æ¢å¤æ­£å¸¸å•¦ï¼';
                    setTimeout(() => {
                        document.title = 'Search Any';
                    }, 1500);
                }, 300);
            }
        });
    </script>
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --input-bg: #f5f5f5;
            --input-border: #e0e0e0;
        }

        .github-corner {
            position: absolute;
            top: 0;
            right: 0;
            z-index: 10;
        }

        .github-corner svg {
            fill: #151513;
            color: #fff;
        }

        .github-corner:hover .octo-arm {
            animation: octocat-wave 560ms ease-in-out;
        }

        @keyframes octocat-wave {

            0%,
            100% {
                transform: rotate(0);
            }

            20%,
            60% {
                transform: rotate(-25deg);
            }

            40%,
            80% {
                transform: rotate(10deg);
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 480px;
            padding: 0 20px;
            box-sizing: border-box;
        }

        .random-image-container {
            text-align: center;
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .random-image {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .search-box {
            width: 100%;
            margin-bottom: 20px;
        }

        #search-input {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            border: 1px solid var(--input-border);
            border-radius: 24px;
            background-color: var(--input-bg);
            color: var(--text-color);
            outline: none;
            box-sizing: border-box;
        }

        .engine-options {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .engine-option {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 12px;
            border-radius: 16px;
            background-color: var(--input-bg);
            cursor: pointer;
            border: 1px solid transparent;
        }

        .engine-option.selected {
            border-color: var(--text-color);
        }

        .engine-option input {
            display: none;
        }

        .engine-option label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }

        .shortcut-hint {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
            text-align: center;
        }

        /* å¿«æ·æ–¹å¼æ ·å¼ */
        .shortcuts-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .shortcut-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            background-color: var(--input-bg);
            cursor: pointer;
            transition: transform 0.2s;
            text-align: center;
            position: relative;
        }

        .shortcut-item:hover {
            transform: translateY(-3px);
        }

        .shortcut-icon {
            width: 32px;
            height: 32px;
            margin-bottom: 8px;
            border-radius: 4px;
        }

        .shortcut-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 100%;
        }

        .shortcut-description {
            font-size: 12px;
            color: #666;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .delete-shortcut-btn, .edit-shortcut-btn {
            position: absolute;
            top: 5px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.9);
            border: none;
            color: #999;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            align-items: center;
            justify-content: center;
        }

        .delete-shortcut-btn {
            right: 5px;
        }

        .edit-shortcut-btn {
            right: 35px;
        }

        .shortcut-item:hover .delete-shortcut-btn,
        .shortcut-item:hover .edit-shortcut-btn {
            display: flex;
        }

        .delete-shortcut-btn:hover {
            background-color: #ff4444;
            color: white;
            transform: scale(1.1);
        }

        .edit-shortcut-btn:hover {
            background-color: #4285f4;
            color: white;
            transform: scale(1.1);
        }

        .add-shortcut-container {
            text-align: center;
            margin: 10px 0;
        }

        .add-shortcut-btn {
            padding: 8px 16px;
            background-color: var(--input-bg);
            border: 1px solid var(--input-border);
            border-radius: 16px;
            cursor: pointer;
            font-size: 14px;
        }

        .add-shortcut-btn:hover {
            background-color: var(--input-border);
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: var(--bg-color);
            margin: 10% auto;
            padding: 20px;
            border: 1px solid var(--input-border);
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .close {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--text-color);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--input-border);
            border-radius: 4px;
            background-color: var(--input-bg);
            color: var(--text-color);
            box-sizing: border-box;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-group input[type="file"] {
            margin-top: 5px;
        }

        .modal-content button {
            width: 100%;
            padding: 10px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        .modal-content button:hover {
            background-color: #3367d6;
        }

        .theme-toggle {
            display: flex;
            gap: 10px;
            position: absolute;
            top: 20px;
            right: 85px;
        }

        .toolbox-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 8px 16px;
            background-color: var(--input-bg);
            border-radius: 16px;
            cursor: pointer;
            border: 1px solid var(--input-border);
        }

        .toolbox-drawer {
            position: absolute;
            top: 60px;
            left: 20px;
            background-color: var(--bg-color);
            border: 1px solid var(--input-border);
            border-radius: 8px;
            padding: 10px;
            display: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .toolbox-item {
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            margin: 4px 0;
        }

        .toolbox-item:hover {
            background-color: var(--input-bg);
        }

        .theme-btn {
            padding: 6px 12px;
            border-radius: 16px;
            background-color: white;
            border: none;
            cursor: pointer;
            font-size: 18px;
        }

        .theme-btn.active {
            background-color: #4285f4;
            color: white;
            border-color: #4285f4;
        }

        [data-theme="dark"] .theme-btn {
            background-color: #2d2d2d;
        }

        /* ä¸»é¢˜æ ·å¼ */
        [data-theme="light"] {
            --bg-color: #ffffff;
            --text-color: #333333;
            --input-bg: #f5f5f5;
            --input-border: #e0e0e0;
        }

        [data-theme="dark"] {
            --bg-color: #1e1e1e;
            --text-color: #f5f5f5;
            --input-bg: #2d2d2d;
            --input-border: #444444;
        }

        @media (prefers-color-scheme: dark) {
            :root:not([data-theme="light"]) {
                --bg-color: #1e1e1e;
                --text-color: #f5f5f5;
                --input-bg: #2d2d2d;
                --input-border: #444444;
            }
        }
    </style>
    <a href="https://github.com/SteamedBread2333/search-any" class="github-corner" aria-label="View source on GitHub">
        <svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path
                d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                fill="currentColor" class="octo-arm"></path>
            <path
                d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                fill="currentColor" class="octo-body"></path>
        </svg>
    </a>
</head>

<body>
    <div class="toolbox-toggle" id="toolbox-toggle">ğŸ§° å·¥å…·ç®±</div>
    <div class="toolbox-drawer" id="toolbox-drawer">
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109400451645491', '_blank') : window.open('json2typescript.html', '_blank')">
            ğŸ”„ JSONè½¬TypeScript
        </div>
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109291132305459', '_blank') : window.open('image2base64.html', '_blank')">
            ğŸ–¼ï¸ å›¾ç‰‡è½¬Base64
        </div>
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109166636302345', '_blank') : window.open('color-converter.html', '_blank')">
            ğŸ¨ é¢œè‰²è½¬æ¢å·¥å…·
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/rmbg-tool`, '_blank')">
            ğŸŒ  åˆ é™¤èƒŒæ™¯å·¥å…·
        </div>
        <div class="toolbox-item" onclick="window.open(`https://steamedbread2333.github.io/mobile-massage`, '_blank')">
            ğŸ’†â€â™‚ï¸ æ‰‹æœºWebé©¬æ€é¸¡
        </div>
        <div class="toolbox-item"
            onclick="window.open(`https://github.com/SteamedBread2333/shell-commands/tree/main/proxy-to-https`, '_blank')">
            ğŸ¤– æœ¬åœ°ä»£ç†ç”Ÿäº§ç¯å¢ƒ
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/shell-commands`, '_blank')">
            ğŸš§ JS Coderè£…æœºå¿…å¤‡
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/dctc`, '_blank')">
            ğŸ‘¨â€ğŸ’» Tsxè½¬æ¢Html
        </div>
        <div class="toolbox-item" onclick="window.open(`https://github.com/SteamedBread2333/mtgit`, '_blank')">
            ğŸ¤ å¤šä»“åº“åˆå¹¶å·¥å…·
        </div>
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109523451645492', '_blank') : window.open('bmi-calculator.html', '_blank')">
            âš–ï¸ BMI è®¡ç®—å™¨
        </div>
        <div class="toolbox-item" onclick="isJuejinDomain ? window.open('https://aicoding.juejin.cn/pens/7530109646451645493', '_blank') : window.open('dice-3d.html', '_blank')">
            ğŸ² 3D æ·éª°å­
        </div>
        <div class="toolbox-item" onclick="window.open('format-converter.html', '_blank')">
            ğŸ”„ æ ¼å¼è½¬æ¢å·¥å‚
        </div>
    </div>

    <div class="container">
        <div class="random-image-container">
            <img src="https://picsum.photos/400/300" alt="éšæœºå›¾ç‰‡" class="random-image">
        </div>
        <div class="search-box">
            <input type="text" id="search-input" placeholder="æœç´¢â€¦" autofocus>
            <div class="shortcut-hint"></div>
        </div>
        
        <div class="engine-options">
            <div class="engine-option" data-engine="google">
                <input type="radio" name="engine" id="google" checked>
                <label for="google">ğŸ” Google</label>
            </div>
            <div class="engine-option" data-engine="baidu">
                <input type="radio" name="engine" id="baidu">
                <label for="baidu">ğŸ” ç™¾åº¦</label>
            </div>
            <div class="engine-option" data-engine="bing">
                <input type="radio" name="engine" id="bing">
                <label for="bing">ğŸ” å¿…åº”</label>
            </div>
        </div>

        <!-- å¿«æ·æ–¹å¼åŒºåŸŸ -->
        <div class="shortcuts-container" id="shortcuts-container">
            <!-- å¿«æ·æ–¹å¼å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
        </div>
        
        <!-- æ·»åŠ å¿«æ·æ–¹å¼æŒ‰é’® -->
        <div class="add-shortcut-container">
            <button class="add-shortcut-btn" id="add-shortcut-btn">â• æ·»åŠ å¿«æ·æ–¹å¼</button>
        </div>
        
        <!-- æ·»åŠ å¿«æ·æ–¹å¼æ¨¡æ€æ¡† -->
        <div class="modal" id="shortcut-modal">
            <div class="modal-content">
                <span class="close" id="close-modal">&times;</span>
                <h2>æ·»åŠ å¿«æ·æ–¹å¼</h2>
                <form id="shortcut-form">
                    <div class="form-group">
                        <label for="shortcut-name">åç§°:</label>
                        <input type="text" id="shortcut-name" required>
                    </div>
                    <div class="form-group">
                        <label for="shortcut-url">é“¾æ¥:</label>
                        <input type="url" id="shortcut-url" required>
                    </div>
                    <div class="form-group">
                        <label for="shortcut-description">æè¿°:</label>
                        <textarea id="shortcut-description"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="shortcut-icon">å›¾æ ‡ (å¯é€‰):</label>
                        <input type="text" id="shortcut-icon" placeholder="å›¾æ ‡URL">
                        <input type="file" id="shortcut-icon-upload" accept="image/*">
                    </div>
                    <button type="submit">æ·»åŠ </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // æœç´¢å¼•æ“é…ç½®
        const engines = {
            google: {
                name: 'Google',
                url: 'https://www.google.com/search?q='
            },
            baidu: {
                name: 'ç™¾åº¦',
                url: 'https://www.baidu.com/s?wd='
            },
            bing: {
                name: 'å¿…åº”',
                url: 'https://www.bing.com/search?q='
            }
        };

        // DOMå…ƒç´ 
        const searchInput = document.getElementById('search-input');
        const engineOptions = document.querySelectorAll('.engine-option');

        // å½“å‰é€‰æ‹©çš„æœç´¢å¼•æ“
        let currentEngine = 'google';

        // æ£€æŸ¥åŸŸåæ˜¯å¦åŒ…å«juejin
        const isJuejinDomain = window.location.href.includes('code.devrank');
        
        // å·¥å…·ç®±åˆ‡æ¢
        document.getElementById('toolbox-toggle').addEventListener('click', function () {
            this.focus();
        });
        
        document.addEventListener('click', function(event) {
            const drawer = document.getElementById('toolbox-drawer');
            const toggle = document.getElementById('toolbox-toggle');
            
            if (drawer.style.display === 'block' && 
                !drawer.contains(event.target) && 
                !toggle.contains(event.target)) {
                drawer.style.display = 'none';
            }
        });
        
        document.getElementById('toolbox-toggle').addEventListener('click', function () {
            const drawer = document.getElementById('toolbox-drawer');
            drawer.style.display = drawer.style.display === 'block' ? 'none' : 'block';
        });

        // å¿«æ·æ–¹å¼åŠŸèƒ½
        let shortcuts = [];
        
        // åˆå§‹åŒ–
        function init() {
            // ä»localStorageè¯»å–ä¸Šæ¬¡é€‰æ‹©çš„æœç´¢å¼•æ“
            const savedEngine = localStorage.getItem('searchEngine');
            if (savedEngine && engines[savedEngine]) {
                currentEngine = savedEngine;
                document.getElementById(savedEngine).checked = true;
                updateEngineSelection();
            }

            // æ·»åŠ äº‹ä»¶ç›‘å¬
            searchInput.addEventListener('keydown', handleSearch);
            engineOptions.forEach(option => {
                option.addEventListener('click', handleEngineChange);
            });

            // æ·»åŠ å¿«æ·é”®ç›‘å¬
            document.addEventListener('keydown', handleShortcuts);

            // ä¸»é¢˜æ¨¡å¼åˆ‡æ¢
            const themeToggle = document.createElement('div');
            themeToggle.className = 'theme-toggle';
            themeToggle.innerHTML = `
             <button class="theme-btn" data-theme="auto">ğŸŒ“</button>
             <button class="theme-btn" data-theme="light">ğŸŒ</button>
             <button class="theme-btn" data-theme="dark">ğŸŒ™</button>
         `;
            document.body.appendChild(themeToggle);

            // åˆå§‹åŒ–ä¸»é¢˜
            let currentTheme = 'auto';
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                currentTheme = savedTheme;
                applyTheme(currentTheme);
            }

            // ä¸»é¢˜åˆ‡æ¢äº‹ä»¶
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    currentTheme = btn.dataset.theme;
                    localStorage.setItem('theme', currentTheme);
                    applyTheme(currentTheme);
                });
            });

            // åº”ç”¨ä¸»é¢˜
            function applyTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);

                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.theme === theme);
                });
            }

            // æ˜¾ç¤ºå¿«æ·é”®æç¤º
            function showShortcutHint() {
                const hint = document.createElement('div');
                hint.className = 'shortcut-hint';
                hint.textContent = 'å¿«æ·é”®: Ctrl+Kèšç„¦ | Ctrl+1/2/3åˆ‡æ¢ | Ctrl+Læ¸…ç©º';
                document.querySelector('.search-box').appendChild(hint);
            }

            showShortcutHint();
            
            // åˆå§‹åŒ–å¿«æ·æ–¹å¼åŠŸèƒ½
            initShortcuts();
        }

        // åˆå§‹åŒ–å¿«æ·æ–¹å¼
        function initShortcuts() {
            // ä»localStorageåŠ è½½å¿«æ·æ–¹å¼
            loadShortcuts();
            
            // æ˜¾ç¤ºå¿«æ·æ–¹å¼
            renderShortcuts();
            
            // æ·»åŠ å¿«æ·æ–¹å¼æŒ‰é’®äº‹ä»¶
            document.getElementById('add-shortcut-btn').addEventListener('click', () => {
                document.getElementById('shortcut-modal').style.display = 'block';
            });
            
            // å…³é—­æ¨¡æ€æ¡†
            document.getElementById('close-modal').addEventListener('click', () => {
                document.getElementById('shortcut-modal').style.display = 'none';
            });
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            window.addEventListener('click', (event) => {
                const modal = document.getElementById('shortcut-modal');
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // å¤„ç†è¡¨å•æäº¤
            document.getElementById('shortcut-form').addEventListener('submit', (e) => {
                e.preventDefault();
                addShortcut();
            });
        }

        // ä»localStorageåŠ è½½å¿«æ·æ–¹å¼
        function loadShortcuts() {
            const saved = localStorage.getItem('shortcuts');
            if (saved) {
                shortcuts = JSON.parse(saved);
            }
        }

        // ä¿å­˜å¿«æ·æ–¹å¼åˆ°localStorage
        function saveShortcuts() {
            localStorage.setItem('shortcuts', JSON.stringify(shortcuts));
        }

        // åˆ é™¤å¿«æ·æ–¹å¼
        function deleteShortcut(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¿«æ·æ–¹å¼å—ï¼Ÿ')) {
                shortcuts = shortcuts.filter(shortcut => shortcut.id !== id);
                saveShortcuts();
                renderShortcuts();
            }
        }

        // ç¼–è¾‘å¿«æ·æ–¹å¼
        function editShortcut(id) {
            const shortcut = shortcuts.find(s => s.id === id);
            if (shortcut) {
                // å¡«å……è¡¨å•æ•°æ®
                document.getElementById('shortcut-name').value = shortcut.name;
                document.getElementById('shortcut-url').value = shortcut.url;
                document.getElementById('shortcut-description').value = shortcut.description;
                document.getElementById('shortcut-icon').value = shortcut.icon || '';
                
                // æ¸…ç©ºæ–‡ä»¶è¾“å…¥
                document.getElementById('shortcut-icon-upload').value = '';
                
                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                document.getElementById('shortcut-modal').style.display = 'block';
                
                // æ›´æ”¹è¡¨å•æäº¤å¤„ç†ç¨‹åº
                const form = document.getElementById('shortcut-form');
                
                // ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨
                const newForm = form.cloneNode(true);
                form.parentNode.replaceChild(newForm, form);
                
                // æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
                newForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    updateShortcut(id);
                });
            }
        }

        // æ›´æ–°å¿«æ·æ–¹å¼
        function updateShortcut(id) {
            const name = document.getElementById('shortcut-name').value;
            const url = document.getElementById('shortcut-url').value;
            const description = document.getElementById('shortcut-description').value;
            const iconUrl = document.getElementById('shortcut-icon').value;
            
            // å¤„ç†å›¾æ ‡ä¸Šä¼ 
            const fileInput = document.getElementById('shortcut-icon-upload');
            
            // æ‰¾åˆ°è¦æ›´æ–°çš„å¿«æ·æ–¹å¼
            const shortcutIndex = shortcuts.findIndex(s => s.id === id);
            if (shortcutIndex !== -1) {
                // æ›´æ–°å¿«æ·æ–¹å¼å¯¹è±¡
                const updatedShortcut = {
                    id: id,
                    name,
                    url,
                    description,
                    icon: iconUrl || null
                };
                
                // å¦‚æœæœ‰ä¸Šä¼ çš„æ–‡ä»¶ï¼Œè¯»å–ä¸ºbase64
                if (fileInput.files && fileInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        updatedShortcut.icon = e.target.result;
                        finishUpdateShortcut(shortcutIndex, updatedShortcut);
                    };
                    reader.readAsDataURL(fileInput.files[0]);
                } else {
                    // å¦‚æœæ²¡æœ‰ä¸Šä¼ æ–‡ä»¶ï¼Œå°è¯•è·å–ç½‘ç«™å›¾æ ‡
                    if (!iconUrl) {
                        // ä½¿ç”¨æ›´é«˜æ¸…çš„faviconæœåŠ¡
                        updatedShortcut.icon = `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64`;
                    }
                    finishUpdateShortcut(shortcutIndex, updatedShortcut);
                }
            }
        }

        // å®Œæˆæ›´æ–°å¿«æ·æ–¹å¼
        function finishUpdateShortcut(index, updatedShortcut) {
            shortcuts[index] = updatedShortcut;
            saveShortcuts();
            renderShortcuts();
            
            // é‡ç½®è¡¨å•å¹¶å…³é—­æ¨¡æ€æ¡†
            document.getElementById('shortcut-form').reset();
            document.getElementById('shortcut-modal').style.display = 'none';
            
            // æ¢å¤æ·»åŠ å¿«æ·æ–¹å¼çš„è¡¨å•å¤„ç†ç¨‹åº
            const form = document.getElementById('shortcut-form');
            const newForm = form.cloneNode(true);
            form.parentNode.replaceChild(newForm, form);
            newForm.addEventListener('submit', (e) => {
                e.preventDefault();
                addShortcut();
            });
        }

        // æ·»åŠ å¿«æ·æ–¹å¼
        function addShortcut() {
            const name = document.getElementById('shortcut-name').value;
            const url = document.getElementById('shortcut-url').value;
            const description = document.getElementById('shortcut-description').value;
            const iconUrl = document.getElementById('shortcut-icon').value;
            
            // å¤„ç†å›¾æ ‡ä¸Šä¼ 
            const fileInput = document.getElementById('shortcut-icon-upload');
            
            // åˆ›å»ºå¿«æ·æ–¹å¼å¯¹è±¡
            const shortcut = {
                id: Date.now(),
                name,
                url,
                description,
                icon: iconUrl || null
            };
            
            // å¦‚æœæœ‰ä¸Šä¼ çš„æ–‡ä»¶ï¼Œè¯»å–ä¸ºbase64
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    shortcut.icon = e.target.result;
                    finishAddShortcut(shortcut);
                };
                reader.readAsDataURL(fileInput.files[0]);
            } else {
                // å¦‚æœæ²¡æœ‰ä¸Šä¼ æ–‡ä»¶ï¼Œå°è¯•è·å–ç½‘ç«™å›¾æ ‡
                if (!iconUrl) {
                    // ä½¿ç”¨æ›´é«˜æ¸…çš„faviconæœåŠ¡
                    shortcut.icon = `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64`;
                }
                finishAddShortcut(shortcut);
            }
        }

        // å®Œæˆæ·»åŠ å¿«æ·æ–¹å¼
        function finishAddShortcut(shortcut) {
            shortcuts.push(shortcut);
            saveShortcuts();
            renderShortcuts();
            
            // é‡ç½®è¡¨å•å¹¶å…³é—­æ¨¡æ€æ¡†
            document.getElementById('shortcut-form').reset();
            document.getElementById('shortcut-modal').style.display = 'none';
        }

        // æ¸²æŸ“å¿«æ·æ–¹å¼
        function renderShortcuts() {
            const container = document.getElementById('shortcuts-container');
            container.innerHTML = '';
            
            shortcuts.forEach(shortcut => {
                const item = document.createElement('div');
                item.className = 'shortcut-item';
                
                // åˆ›å»ºå¿«æ·æ–¹å¼å†…å®¹
                const iconHtml = shortcut.icon ? `<img src="${shortcut.icon}" alt="${shortcut.name}" class="shortcut-icon">` : '';
                const nameHtml = `<div class="shortcut-name">${shortcut.name}</div>`;
                const descHtml = `<div class="shortcut-description">${shortcut.description}</div>`;
                const editBtnHtml = `<button class="edit-shortcut-btn" data-id="${shortcut.id}">âœ</button>`;
                const deleteBtnHtml = `<button class="delete-shortcut-btn" data-id="${shortcut.id}">âœ•</button>`;
                
                item.innerHTML = iconHtml + nameHtml + descHtml + editBtnHtml + deleteBtnHtml;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                item.addEventListener('click', (e) => {
                    // é˜»æ­¢äº‹ä»¶å†’æ³¡
                    e.stopPropagation();
                    
                    // å¦‚æœç‚¹å‡»çš„æ˜¯åˆ é™¤æŒ‰é’®ï¼Œåˆ™æ‰§è¡Œåˆ é™¤åŠŸèƒ½
                    if (e.target.classList.contains('delete-shortcut-btn')) {
                        e.preventDefault();
                        const id = parseInt(e.target.dataset.id);
                        deleteShortcut(id);
                        return;
                    }
                    
                    // å¦‚æœç‚¹å‡»çš„æ˜¯ç¼–è¾‘æŒ‰é’®ï¼Œåˆ™æ‰§è¡Œç¼–è¾‘åŠŸèƒ½
                    if (e.target.classList.contains('edit-shortcut-btn')) {
                        e.preventDefault();
                        const id = parseInt(e.target.dataset.id);
                        editShortcut(id);
                        return;
                    }
                    
                    // å¦åˆ™æ‰“å¼€é“¾æ¥
                    window.open(shortcut.url, '_blank');
                });
                
                container.appendChild(item);
            });
        }

        // å¤„ç†æœç´¢
        function handleSearch(e) {
            if (e.key === 'Enter') {
                const query = searchInput.value.trim();
                if (query) {
                    window.open(engines[currentEngine].url + encodeURIComponent(query), '_blank');
                }
            }
        }

        // å¤„ç†æœç´¢å¼•æ“åˆ‡æ¢
        function handleEngineChange(e) {
            const selectedEngine = this.dataset.engine;
            if (selectedEngine && engines[selectedEngine]) {
                currentEngine = selectedEngine;
                localStorage.setItem('searchEngine', selectedEngine);
                updateEngineSelection();
                searchInput.focus();
            }
        }

        // æ›´æ–°æœç´¢å¼•æ“é€‰æ‹©çŠ¶æ€
        function updateEngineSelection() {
            engineOptions.forEach(option => {
                if (option.dataset.engine === currentEngine) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        }

        // å¤„ç†å¿«æ·é”®
        function handleShortcuts(e) {
            // å¤„ç†å¿«æ·é”®
            if (e.ctrlKey) {
                // Ctrl+K èšç„¦æœç´¢æ¡†
                if (e.key.toLowerCase() === 'k') {
                    e.preventDefault();
                    searchInput.focus();
                    return;
                }

                // Ctrl+L æ¸…ç©ºè¾“å…¥æ¡†
                if (e.key.toLowerCase() === 'l') {
                    e.preventDefault();
                    searchInput.value = '';
                    searchInput.focus();
                    return;
                }

                // Ctrl+1/2/3 åˆ‡æ¢æœç´¢å¼•æ“
                if (e.key >= '1' && e.key <= '3') {
                    e.preventDefault();
                    const engineIndex = parseInt(e.key) - 1;
                    const engineKeys = Object.keys(engines);
                    if (engineIndex < engineKeys.length) {
                        currentEngine = engineKeys[engineIndex];
                        localStorage.setItem('searchEngine', currentEngine);
                        document.getElementById(currentEngine).checked = true;
                        updateEngineSelection();
                        searchInput.focus();
                    }
                    return;
                }
            }
        }

        // å¯åŠ¨åº”ç”¨
        init();
    </script>
</body>

</html>